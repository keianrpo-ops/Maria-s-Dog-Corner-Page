!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2e8472e4-ff57-4886-a0db-fd50e1e023f7",e._sentryDebugIdIdentifier="sentry-dbid-2e8472e4-ff57-4886-a0db-fd50e1e023f7")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"c5d46717f"},(globalThis.webpackSSRJSONP=globalThis.webpackSSRJSONP||[]).push([[6977],{10031:(e,t,i)=>{i.d(t,{A:()=>n});var s=i(20983),r=i(80108);class n{constructor(e){this.id=void 0,this.uri=void 0,this.file=void 0,this.type=void 0,this.size=void 0,this.name=void 0;const t=e;if(!e.type?.startsWith("image")&&!e.type?.startsWith("video"))throw new Error("MediaFiles may only be constructed from image or video files");this.uri=URL.createObjectURL(e),this.id=(0,s.v4)(),this.file=e,this.type=e.type.startsWith("image")?r.z.IMAGE:r.z.VIDEO,this.size=t.size,this.name=t.name}}},64809:(e,t,i)=>{i.d(t,{D:()=>m,Jr:()=>n,ZN:()=>c,o_:()=>o});var s=i(98482);class r extends Error{constructor(e){super(e),this.message=e,this.userFacingMessage=void 0,this.name="MediaSelectionError",Object.setPrototypeOf(this,r.prototype)}}class n extends r{constructor(){super(n.message),Object.setPrototypeOf(this,n.prototype),this.userFacingMessage=n.userFacingMessage}}n.message="No files selected",n.userFacingMessage=s.Ru._({id:"16iVWd"});class a extends r{constructor(){super(a.message),Object.setPrototypeOf(this,a.prototype),this.userFacingMessage=a.userFacingMessage}}a.message="Selection cancelled",a.userFacingMessage=void 0;class o extends r{constructor(){super(o.message),Object.setPrototypeOf(this,o.prototype),this.userFacingMessage=o.userFacingMessage}}o.message="Invalid media file type",o.userFacingMessage=s.Ru._({id:"eW0Ldg"});class c extends r{constructor(){super(c.message),Object.setPrototypeOf(this,c.prototype),this.userFacingMessage=c.userFacingMessage}}c.message="File contents do not match extension",c.userFacingMessage=s.Ru._({id:"/SE5NA"});class h extends r{constructor(){super(h.message),Object.setPrototypeOf(this,h.prototype),this.userFacingMessage=h.userFacingMessage}}h.message="Camera is unavailable",h.userFacingMessage=s.Ru._({id:"enbWhI"});class f extends r{constructor(){super(f.message),Object.setPrototypeOf(this,f.prototype),this.userFacingMessage=f.userFacingMessage}}f.message="Permissions not granted",f.userFacingMessage=s.Ru._({id:"rmshyd"});class u extends r{constructor(e){super(`Resize error: ${e}`),this.sourceErr=e,Object.setPrototypeOf(this,u.prototype),this.userFacingMessage=u.userFacingMessage}}u.userFacingMessage=s.Ru._({id:"jnfI6e"});class m extends r{constructor(e){super(`Unknown error: ${e}`),this.sourceErr=e,Object.setPrototypeOf(this,m.prototype),this.userFacingMessage=m.userFacingMessage}}m.userFacingMessage=s.Ru._({id:"hnqpk7"})},6977:(e,t,i)=>{i.d(t,{bb:()=>B.A,zu:()=>u.z,o3:()=>A,Iv:()=>E,rm:()=>U});var s=i(65451),r=i(32153),n=i(16810),a=i(74863),o=i(1109);class c{constructor(e){this.rawResponse=void 0,this.body=void 0,this.rawResponse=e,this.body=(0,o.PT)(e.data,!0)}}var h=i(11664);async function f(e,t,i,s){const n=s||(0,a.w5)();try{const s=await n.post(e,"string"==typeof t?t:(0,o.p7)(t),i);return(0,r.ok)(new c(s))}catch(e){const t=(0,h.A)(e);return(0,r._q)(t)}}var u=i(80108),m=i(98482);const p=20971520;class l extends Error{constructor(e){super(e),this.message=e,this.userFacingMessage=void 0,this.retryable=void 0,this.name="MediaUploadError",Object.setPrototypeOf(this,l.prototype)}}class d extends l{constructor(e){super(`Expo Module Error: ${e}`),Object.setPrototypeOf(this,d.prototype),this.userFacingMessage=d.userFacingMessage}}d.message="Expo Module Error",d.userFacingMessage=m.Ru._({id:"MkWy4b"});class g extends l{constructor(){super(g.message),Object.setPrototypeOf(this,g.prototype),this.userFacingMessage=g.userFacingMessage}}g.message="Not Authorized",g.userFacingMessage=m.Ru._({id:"JGcHpi"});class k extends l{constructor(){super(k.message),this.retryable=!0,Object.setPrototypeOf(this,k.prototype),this.userFacingMessage=k.userFacingMessage}}k.message="Network Error",k.userFacingMessage=m.Ru._({id:"kkPIjA"});class x extends l{constructor(){super(x.message),Object.setPrototypeOf(this,x.prototype),this.userFacingMessage=x.userFacingMessage}}x.message="Maximum image upload file size of 20971520 exceeded",x.userFacingMessage=m.Ru._({id:"FozGxg"});class w extends l{constructor(){super(w.message),Object.setPrototypeOf(this,w.prototype),this.userFacingMessage=w.userFacingMessage}}w.message="Client Error",w.userFacingMessage=m.Ru._({id:"sbPXJR"});class y extends l{constructor(){super(y.message),Object.setPrototypeOf(this,y.prototype),this.userFacingMessage=y.userFacingMessage}}y.message="Server Error",y.userFacingMessage=m.Ru._({id:"xPdAp0"});class v extends l{constructor(e){super(`Unknown error: ${e}`),this.sourceErr=e,Object.setPrototypeOf(this,v.prototype),this.userFacingMessage=v.userFacingMessage}}v.userFacingMessage=m.Ru._({id:"hnqpk7"});function b(e,t){return e.isOk()?(0,r.ok)(!0):e.error instanceof n.D?(0,r._q)(new k):e.error.statusCode.toString().startsWith("4")?(0,r._q)(new w):e.error.statusCode.toString().startsWith("5")?(0,r._q)(new y):(console.error(e),(0,r._q)(new v(new Error(`Unknown error during ${t}`))))}var S=i(20983),T=i(21781);class M{constructor(e,t,i){this.file=void 0,this.id=void 0,this.options=void 0,this.progress=void 0,this.retryCount=void 0,this.result=void 0,this.status=void 0,this.listeners=void 0,this.expoTask=void 0,this.setStatus=e=>{this.status=e,this.handleOnProgress()},this.setProgress=e=>{this.progress=e,this.handleOnProgress()},this.setResult=e=>{this.result=e,this.handleOnFinish()},this.setExpoTask=e=>{this.expoTask=e},T.env.JEST_WORKER_ID||console.debug(`constructing new UploadTask for ${e.name}`),this.file=e,this.id=e.id,this.options=t||{},this.progress=0,this.listeners={},this.retryCount=0,this.status="queued",this.expoTask=void 0,i&&this.attachListeners(i)}handleOnProgress(){Object.values(this.listeners).forEach((e=>e.onProgress?.(this)))}handleOnFinish(){Object.values(this.listeners).forEach((e=>e.onFinish?.(this))),this.listeners={}}handleOnCancel(){Object.values(this.listeners).forEach((e=>e.onCancel?.(this)))}start(){this.progress=0,this.setStatus("in progress")}updateProgress(e){this.setProgress(e)}shouldRetry(){return void 0!==this.options.timesToAutoRetry&&this.options.timesToAutoRetry>0&&this.options.timesToAutoRetry>this.retryCount}complete(e){this.status="complete",this.setResult((0,r.ok)({url:e}))}async fail(e){if(this.shouldRetry()){const e=this.options.secondsBetweenAutoRetries??10;setTimeout((()=>{this.retryCount+=1,this.setProgress(0),Object.values(this.listeners).forEach((e=>e.onRetry?.(this)))}),1e3*e)}else this.status="errored",this.setResult((0,r._q)(e))}async cancel(){this.result=(0,r.ok)({url:""}),this.status="cancelled",await(this.expoTask?.cancelAsync()),this.handleOnCancel()}attachListeners(e){const t=(0,S.v4)();return this.listeners[t]=e,()=>this.removeListeners(t)}removeListeners(e){this.listeners[e]&&delete this.listeners[e]}isSuccessful(){return"complete"===(e=this).status&&!!e.result?.isOk();var e}isInProgress(){return"in progress"===(e=this).status||"queued"===e.status;var e}isFailed(){return"errored"===(e=this).status&&!!e.result?.isErr();var e}isCancelled(){return"cancelled"===(e=this).status&&!!e.result?.isOk();var e}isAttachable(){const e=this.result?.isOk(),{attach:t}=this.options;return!(!e||!t)}}var F=i(13768);async function P(e,t){const{type:i,file:s}=e.file,n=await async function(e,t,i){const s=(0,a.w5)();try{if(!t.type)throw new Error("Cannot PUT data without a type param");const n=await s.put(e,t,{headers:{"Content-Type":t.type,"Content-Disposition":"inline"},...i});return(0,r.ok)(new c(n))}catch(e){const t=(0,h.A)(e);return(0,r._q)(t)}}(t,s,{onUploadProgress:t=>{const i=Math.round(t.loaded/t.total*100);e.updateProgress(i)}});return b(n,`${i} upload to S3`)}class O{constructor(){this.currentTask=void 0,this.handleTaskRetry=()=>{this.currentTask&&(this.currentTask.isCancelled()?this.handleTaskFinish():O.runUploadTask(this.currentTask))},this.handleTaskFinish=()=>{this.currentTask=void 0},this.currentTask=void 0}startTask(e){return!this.currentTask&&(e.isCancelled()?(this.handleTaskFinish(),!1):(this.currentTask=e,this.currentTask.attachListeners({onFinish:this.handleTaskFinish,onRetry:this.handleTaskRetry,onCancel:this.handleTaskFinish}),O.runUploadTask(this.currentTask),!0))}static async runUploadTask(e){const{type:t,size:i}=e.file;if(F.V.debug("rsdk.media.uploadMedia.start",{mediaType:t}),e.isCancelled())return void F.V.debug("rsdk.media.uploadMedia.uploadCancelled",{mediaType:t});if(e.start(),t===u.z.IMAGE&&i>p)return void e.fail(new x);const s=await O.auth(e);if(s.isOk()){F.V.debug("rsdk.media.uploadMedia.authSuccess",{mediaType:t});const{uploadUrl:i}=s.value,r=await O.upload(e,i);if(r.isOk()){if(e.isCancelled())return void F.V.debug("rsdk.media.uploadMedia.uploadCancelled",{mediaType:t});F.V.debug("rsdk.media.uploadMedia.uploadSuccess",{mediaType:t});const s=i.split("?")[0];if(e.isAttachable()){const i=await O.attach(e);i.isOk()?(F.V.debug("rsdk.media.uploadMedia.attachSuccess",{mediaType:t}),e.complete(s)):(e.fail(i.error),F.V.error(i.error,{mediaType:t}))}else e.complete(s)}else e.fail(r.error),F.V.error(r.error,{mediaType:t})}else e.fail(s.error),F.V.error(s.error,{mediaType:t})}static async auth(e){const t=await(({file:e,type:t},i)=>{const s=`/api/v7/${t===u.z.IMAGE?"images":"videos"}/upload/authorize/`;let r;return r=File&&e instanceof File?{fileName:e.name,contentType:e.type}:{fileName:e.fileName||"",contentType:e.type||""},f(s,{...r,...i})})(e.file,e.options);return t.isOk()?(0,r.ok)(t.value.body):t.error instanceof n.D?(0,r._q)(new k):401===t.error.statusCode?(0,r._q)(new g):t.error.statusCode.toString().startsWith("5")?(0,r._q)(new y):(0,r._q)(new v(new Error(`Unknown error during ${e.file.type} upload authorization`)))}static async upload(e,t){return P(e,t)}static async attach(e){return async function(e){const{type:t}=e.file,{url:i}=e.result.value,{caption:s,contentObjectMediaUrl:r}=e.options.attach;let n;return n=t===u.z.IMAGE?{imageUrl:i,...void 0!==s&&{caption:s}}:{videoUrl:i},b(await f(r,n),`${t} attach`)}(e)}}var z=i(99167);const E=(e={})=>{const[t,i]=(0,s.useState)([]),[r,n]=(0,s.useState)(),a=t=>{t.isOk()?(r&&n(void 0),i(t.value),e.onSelectionSuccess&&e.onSelectionSuccess(t.value)):(console.error(t.error),n(t.error))};return{error:r,inputProps:{...(0,z.ph)(e),onChange:async e=>{a(await(0,z.Ad)(e))}},dropzoneProps:{...(0,z.or)(e),onDrop:async(...e)=>{a(await(0,z.S)(...e))}},selectedMedia:t,selectMedia:()=>{console.warn("Calling selectMedia on web has no effect. Use a file input element instead.")}}},I=new class{constructor({workerCount:e}){this.uploadTasks=void 0,this.workerPool=void 0,this.persistenceGroups=void 0,this.uploadTasks=new Map,this.workerPool=Array.from(Array(e)).map((()=>new O)),this.persistenceGroups={},setInterval((()=>this.processQueue()),1e3)}add(e,t){const i={};return e.forEach((({file:e,opts:s})=>{const r=new M(e,s,t);this.uploadTasks.set(r.id,r),i[r.id]=r,s?.persistenceKey&&(this.persistenceGroups[s.persistenceKey]?this.persistenceGroups[s.persistenceKey][r.id]=r:this.persistenceGroups[s.persistenceKey]={[r.id]:r})})),i}get nextQueuedTask(){const e=[...this.uploadTasks].filter((([,e])=>"queued"===e.status));return e[0]?e[0][1]:void 0}get availableWorker(){return this.workerPool.find((e=>void 0===e.currentTask))}processQueue(){for(;this.nextQueuedTask&&this.availableWorker;)console.log(`starting task ${this.nextQueuedTask.id} on a worker`),this.availableWorker.startTask(this.nextQueuedTask)}getPersistedTasksForKey(e){return this.persistenceGroups[e]}removePersistedTaskByKey(e,t){this.persistenceGroups[e]&&delete this.persistenceGroups[e][t]}}({workerCount:2}),U=e=>{const t=e?.persistenceKey&&I.getPersistedTasksForKey(e.persistenceKey),[i,r]=(0,s.useState)(t||{}),n=e=>{r((t=>({...t,[e.file.id]:e})))},a=e=>{n(e)},o=e=>{n(e)};(0,s.useEffect)((()=>(t&&Object.values(t).forEach((e=>{e.attachListeners({onProgress:n,onFinish:o,onCancel:a})})),()=>{})),[]);const c=(t,s={})=>{let c=0;const h=t.length,f=((e,t)=>I.add(e,t))(e?.persistenceKey?t.map((t=>({...t,opts:{...t.opts,persistenceKey:e.persistenceKey}}))):t,{onFinish:e=>{e.isSuccessful()&&s.onUploadSuccess&&s.onUploadSuccess?.(e),e.isFailed()&&s.onUploadFailed&&s.onUploadFailed?.(e),e.isCancelled()&&s.onUploadCancelled&&s.onUploadCancelled(e),c+=1,o(e),c===h&&s.onAllFinished&&s.onAllFinished()},onProgress:e=>{n(e),e.isInProgress()&&s.onUploadProgress&&s.onUploadProgress(e)},onCancel:e=>{c+=1,a(e),e.isCancelled()&&s.onUploadCancelled&&s.onUploadCancelled(e)}});r({...i,...f})},h=t=>{(t=>{e?.persistenceKey&&I.removePersistedTaskByKey(e.persistenceKey,t)})(t);const s=i[t];s&&(s.isInProgress()&&s.cancel(),delete i[t],r({...i}))};let f,u=!1;return Object.values(i).forEach((e=>{e.isInProgress()&&(u=!0),!f&&e.result?.isErr()&&(f=e.result.error)})),{error:f,uploadTasks:i,uploadMedia:c,retryUploadTasks:(e,t={})=>{const i=e.map((e=>({file:e.file,opts:e.options})));e.forEach((e=>{h(e.id)})),c(i,t)},removeUploadTask:h,queuedAndInProgressTasks:Object.values(i).filter((e=>e.isInProgress())),successfulUploadTasks:Object.values(i).filter((e=>e.isSuccessful())),failedUploadTasks:Object.values(i).filter((e=>e.isFailed())),isUploading:u}},A=({imageUploadOptions:e,selectOptions:t,uploadListeners:i,uploadOptions:s,persistenceKey:r})=>{const{error:n,isUploading:a,uploadMedia:o,uploadTasks:c,queuedAndInProgressTasks:h,successfulUploadTasks:f,failedUploadTasks:m,retryUploadTasks:p,removeUploadTask:l}=U({persistenceKey:r}),{error:d,inputProps:g,dropzoneProps:k,selectMedia:x}=E({...t,onSelectionSuccess:t=>{const r=t.map((t=>({file:t,opts:{...s,...t.type===u.z.IMAGE?{...e}:{}}})));o(r,i)}});return{dropzoneProps:k,error:d||n,inputProps:g,isUploading:a,selectMedia:x,uploadTasks:c,queuedAndInProgressTasks:h,failedUploadTasks:m,successfulUploadTasks:f,retryUploadTasks:p,removeUploadTask:l}};var B=i(10031);i(64809)},99167:(e,t,i)=>{i.d(t,{iB:()=>I,S:()=>R,Ad:()=>C,or:()=>A,ph:()=>U});var s=i(32153),r=i(10833),n=i(13768);let a=null;async function o(){return a||(a=(async()=>{const e=new URL(i(51905),i.b);if(!e)throw new Error("Failed to get WASM URL");const t=await(await fetch(e)).arrayBuffer();await(0,r.ii)(t)})(),a)}async function c(e,t=85){await o();const{file:i,name:s}=e,a=await function(e){return new Promise(((t,i)=>{const s=new FileReader;s.onload=()=>{const e=s.result;t(new Uint8Array(e))},s.onerror=i,File,s.readAsArrayBuffer(e)}))}(i);let c;try{r.Yu.read(a,(e=>{e.quality=t,e.strip(),e.write(r.qX.Jpeg,(e=>{const t=e.slice().buffer;c=new File([t],s,{type:"image/jpeg"})}))}))}catch(e){throw n.V.error(Error(`magick-wasm: toJpeg failed for file ${s}: ${e}`)),e}if(!c)throw new Error("magick-wasm: read/write did not produce output");return c}var h=i(15734);class f extends Error{constructor(...e){super(...e)}}class u{constructor(e){this.fileInfo=void 0,this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=e||{}}async readToken(e,t=this.position){const i=h.hp.alloc(e.len);if(await this.readBuffer(i,{position:t})<e.len)throw new f;return e.get(i,0)}async peekToken(e,t=this.position){const i=h.hp.alloc(e.len);if(await this.peekBuffer(i,{position:t})<e.len)throw new f;return e.get(i,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new f;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new f;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){const t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}class m extends u{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,t){if(t&&t.position){if(t.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=t.position}const i=await this.peekBuffer(e,t);return this.position+=i,i}async peekBuffer(e,t){const i=this.normalizeOptions(e,t),s=Math.min(this.uint8Array.length-i.position,i.length);if(!i.mayBeLess&&s<i.length)throw new f;return e.set(this.uint8Array.subarray(i.position,i.position+s),i.offset),s}async close(){}}i(83132);function p(e){return new DataView(e.buffer,e.byteOffset)}const l={len:1,get:(e,t)=>p(e).getUint8(t),put:(e,t,i)=>(p(e).setUint8(t,i),t+1)},d={len:2,get:(e,t)=>p(e).getUint16(t,!0),put:(e,t,i)=>(p(e).setUint16(t,i,!0),t+2)},g={len:2,get:(e,t)=>p(e).getUint16(t),put:(e,t,i)=>(p(e).setUint16(t,i),t+2)},k={len:4,get:(e,t)=>p(e).getUint32(t,!0),put:(e,t,i)=>(p(e).setUint32(t,i,!0),t+4)},x={len:4,get:(e,t)=>p(e).getUint32(t),put:(e,t,i)=>(p(e).setUint32(t,i),t+4)},w={len:4,get:(e,t)=>p(e).getInt32(t),put:(e,t,i)=>(p(e).setInt32(t,i),t+4)},y={len:8,get:(e,t)=>p(e).getBigUint64(t,!0),put:(e,t,i)=>(p(e).setBigUint64(t,i,!0),t+8)};class v{constructor(e,t){this.len=void 0,this.encoding=void 0,this.len=e,this.encoding=t}get(e,t){return h.hp.from(e).toString(this.encoding,t,t+this.len)}}class b{constructor(e){this.len=void 0,this.len=e}static decode(e,t,i){let s="";for(let r=t;r<i;++r)s+=b.codePointToString(b.singleByteDecoder(e[r]));return s}static inRange(e,t,i){return t<=e&&e<=i}static codePointToString(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}static singleByteDecoder(e){if(b.inRange(e,0,127))return e;const t=b.windows1252[e-128];if(null===t)throw Error("invaliding encoding");return t}get(e,t=0){return b.decode(e,t,t+this.len)}}b.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255];const S={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4};function T(e,t,i){i={offset:0,...i};for(const[s,r]of t.entries())if(i.mask){if(r!==(i.mask[s]&e[s+i.offset]))return!1}else if(r!==e[s+i.offset])return!1;return!0}class M{constructor(){this.buffer=void 0,this.tokenizer=void 0}check(e,t){return!!this.buffer&&T(this.buffer,e,t)}checkString(e,t){return this.check((i=e,[...i].map((e=>e.charCodeAt(0)))),t);var i}async parse(e){if(this.buffer=h.hp.alloc(4100),void 0===e.fileInfo.size&&(e.fileInfo.size=Number.MAX_SAFE_INTEGER),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:12,mayBeLess:!0}),this.check([66,77]))return{ext:"bmp",mime:"image/bmp"};if(this.check([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(this.check([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(this.check([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString("PS-Adobe-",{offset:2})&&this.checkString(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(this.check([31,160])||this.check([31,157]))return{ext:"Z",mime:"application/x-compress"};if(this.check([71,73,70]))return{ext:"gif",mime:"image/gif"};if(this.check([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(this.check([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(this.check([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(this.check([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(this.checkString("ID3")){await e.ignore(6);const t=await e.readToken(S);return e.position+t>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(t),F(e))}if(this.checkString("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===this.buffer[0]||70===this.buffer[0])&&this.check([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(this.checkString("FLIF"))return{ext:"flif",mime:"image/flif"};if(this.checkString("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(this.checkString("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(this.checkString("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(this.checkString("FORM"))return{ext:"aif",mime:"audio/aiff"};if(this.checkString("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(this.check([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(this.buffer,{length:30});const i={compressedSize:this.buffer.readUInt32LE(18),uncompressedSize:this.buffer.readUInt32LE(22),filenameLength:this.buffer.readUInt16LE(26),extraFieldLength:this.buffer.readUInt16LE(28)};if(i.filename=await e.readToken(new v(i.filenameLength,"utf-8")),await e.ignore(i.extraFieldLength),"META-INF/mozilla.rsa"===i.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(i.filename&&(i.filename.endsWith(".rels")||i.filename.endsWith(".xml"))){switch(i.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}}if(i.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(i.filename.startsWith("3D/")&&i.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===i.filename&&i.compressedSize===i.uncompressedSize){const s=await e.readToken(new v(i.compressedSize,"utf-8"));switch(s.trim()){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}}if(0===i.compressedSize){let r=-1;for(;r<0&&e.position<e.fileInfo.size;)await e.peekBuffer(this.buffer,{mayBeLess:!0}),r=this.buffer.indexOf("504B0304",0,"hex"),await e.ignore(r>=0?r:this.buffer.length)}else await e.ignore(i.compressedSize)}}catch(n){if(!(n instanceof f))throw n}return{ext:"zip",mime:"application/zip"}}if(this.checkString("OggS")){await e.ignore(28);const a=h.hp.alloc(8);return await e.readBuffer(a),T(a,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:T(a,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:T(a,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:T(a,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:T(a,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:T(a,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(this.check([80,75])&&(3===this.buffer[2]||5===this.buffer[2]||7===this.buffer[2])&&(4===this.buffer[3]||6===this.buffer[3]||8===this.buffer[3]))return{ext:"zip",mime:"application/zip"};if(this.checkString("ftyp",{offset:4})&&96&this.buffer[8]){const o=this.buffer.toString("binary",8,12).replace("\0"," ").trim();switch(o){case"avif":case"avis":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return o.startsWith("3g")?o.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(this.checkString("MThd"))return{ext:"mid",mime:"audio/midi"};if(this.checkString("wOFF")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(this.checkString("wOF2")&&(this.check([0,1,0,0],{offset:4})||this.checkString("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(this.checkString("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(this.checkString("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(this.checkString("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(this.check([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(this.checkString("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(this.checkString("%PDF")){await e.ignore(1350);const c=10485760,u=h.hp.alloc(Math.min(c,e.fileInfo.size));return await e.readBuffer(u,{mayBeLess:!0}),u.includes(h.hp.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(this.check([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(this.check([73,73])){const m=await this.readTiffHeader(!1);if(m)return m}if(this.check([77,77])){const p=await this.readTiffHeader(!0);if(p)return p}if(this.checkString("MAC "))return{ext:"ape",mime:"audio/ape"};if(this.check([26,69,223,163])){async function d(){const t=await e.peekNumber(l);let i=128,s=0;for(;!(t&i);)++s,i>>=1;const r=h.hp.alloc(s+1);return await e.readBuffer(r),r}async function g(){const e=await d(),t=await d();t[0]^=128>>t.length-1;const i=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-i,i)}}async function k(t,i){for(;i>0;){const t=await g();if(17026===t.id){return(await e.readToken(new v(t.len,"utf-8"))).replace(/\00.*$/g,"")}await e.ignore(t.len),--i}}const x=await g();switch(await k(0,x.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(this.check([82,73,70,70])){if(this.check([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(this.check([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(this.check([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(this.checkString("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(this.check([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(this.checkString("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(this.checkString("MSCF")||this.checkString("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(this.check([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(this.check([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(this.check([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(this.check([127,69,76,70]))return{ext:"elf",mime:"application/x-elf"};if(this.check([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(this.checkString("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(this.checkString("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(this.check([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(this.checkString("IMPM"))return{ext:"it",mime:"audio/x-it"};if(this.checkString("-lh0-",{offset:2})||this.checkString("-lh1-",{offset:2})||this.checkString("-lh2-",{offset:2})||this.checkString("-lh3-",{offset:2})||this.checkString("-lh4-",{offset:2})||this.checkString("-lh5-",{offset:2})||this.checkString("-lh6-",{offset:2})||this.checkString("-lh7-",{offset:2})||this.checkString("-lzs-",{offset:2})||this.checkString("-lz4-",{offset:2})||this.checkString("-lz5-",{offset:2})||this.checkString("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(this.check([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(this.checkString("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(this.check([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(this.checkString("<?xml "))return{ext:"xml",mime:"application/xml"};if(this.check([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(this.check([82,97,114,33,26,7])&&(0===this.buffer[6]||1===this.buffer[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(this.checkString("solid "))return{ext:"stl",mime:"model/stl"};if(this.checkString("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(this.checkString("!<arch>")){await e.ignore(8);return"debian-binary"===await e.readToken(new v(13,"ascii"))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"}}if(this.check([137,80,78,71,13,10,26,10])){async function b(){return{length:await e.readToken(w),type:await e.readToken(new v(4,"binary"))}}await e.ignore(8);do{const M=await b();if(M.length<0)return;switch(M.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(M.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(this.check([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(this.check([239,187,191])&&this.checkString("<?xml",{offset:3}))return{ext:"xml",mime:"application/xml"};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(this.checkString("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function P(){const t=h.hp.alloc(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(y))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){const O=await P();let z=O.size-24;if(T(O.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const E=h.hp.alloc(16);if(z-=await e.readBuffer(E),T(E,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(T(E,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(z)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10])){await e.ignore(20);switch(await e.readToken(new v(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(this.check([254,255,0,60,0,63,0,120,0,109,0,108])||this.check([255,254,60,0,63,0,120,0,109,0,108,0]))return{ext:"xml",mime:"application/xml"};if(this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(this.check([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(this.check([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(this.check([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(this.check([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.checkString("BEGIN:")){if(this.checkString("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(this.checkString("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(this.checkString("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(this.checkString("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(this.checkString("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(this.check([4,0,0,0])&&this.buffer.length>=16){const I=this.buffer.readUInt32LE(12);if(I>12&&this.buffer.length>=I+16)try{const U=this.buffer.slice(16,I+16).toString();if(JSON.parse(U).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(this.checkString("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(this.check([71])&&this.check([71],{offset:188}))return{ext:"mts",mime:"video/mp2t"};if(this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:"mts",mime:"video/mp2t"};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(this.check([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),function(e,t=0){const i=Number.parseInt(e.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(Number.isNaN(i))return!1;let s=256;for(let i=t;i<t+148;i++)s+=e[i];for(let i=t+156;i<t+512;i++)s+=e[i];return i===s}(this.buffer))return{ext:"tar",mime:"application/x-tar"};if(this.check([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(this.checkString("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(this.buffer.length>=2&&this.check([255,224],{offset:0,mask:[255,224]})){if(this.check([16],{offset:1,mask:[22]}))return this.check([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(this.check([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(this.check([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(this.check([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}async readTiffTag(e){const t=await this.tokenizer.readToken(e?g:d);switch(this.tokenizer.ignore(10),t){case 50341:return{ext:"arw",mime:"image/x-sony-arw"};case 50706:return{ext:"dng",mime:"image/x-adobe-dng"}}}async readTiffIFD(e){const t=await this.tokenizer.readToken(e?g:d);for(let i=0;i<t;++i){const t=await this.readTiffTag(e);if(t)return t}}async readTiffHeader(e){const t=(e?g:d).get(this.buffer,2),i=(e?x:k).get(this.buffer,4);if(42===t){if(i>=6){if(this.checkString("CR",{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(i>=8&&(this.check([28,0,254,0],{offset:8})||this.check([31,0,11,0],{offset:8})))return{ext:"nef",mime:"image/x-nikon-nef"}}await this.tokenizer.ignore(i);return await this.readTiffIFD(!1)||{ext:"tif",mime:"image/tiff"}}if(43===t)return{ext:"tif",mime:"image/tiff"}}}async function F(e){try{return(new M).parse(e)}catch(e){if(!(e instanceof f))throw e}}async function P(e){const t=new Uint8Array(e);var i;if(t&&t.length>1)return F(new m(t,i))}const O=async e=>{const t=e.map((async e=>{const t=await async function(e){e.arrayBuffer||(Blob.prototype.arrayBuffer=function(){return new Promise((e=>{const t=new FileReader;t.onload=()=>{e(t.result)},t.readAsArrayBuffer(this)}))});const t=await e.arrayBuffer();return P(h.hp.from(t))}(e);return!!t&&((e,t)=>{const i=e.name.split(".").pop()?.toLocaleLowerCase();return i!==t.ext?"jpeg"===i&&"jpg"===t.ext&&"image/jpeg"===t.mime:e.type===t.mime})(e,t)}));return(await Promise.all(t)).some((e=>!1===e))};var z=i(10031),E=i(80108);const I=e=>Array.from(e,(e=>new z.A(e))),U=({type:e,multiple:t})=>{let i;return i=e?e===E.z.IMAGE?"image/*":"video/*":"image/*,video/*",{type:"file",multiple:t||!1,accept:i}};function A(e){const{type:t,...i}=U(e);return i}var B=i(64809);const C=async e=>{n.V.debug("rsdk.media.selectMedia.start");try{const{files:t}=e?.target||{};if(!t?.length){const e=new B.Jr;return n.V.error(e),(0,s._q)(e)}if(await O(Array.from(t)))return(0,s._q)(new B.ZN);let i=[];const r=[];try{(await I(t)).forEach((e=>{e.type===E.z.IMAGE?i.push(e):r.push(e)})),i=await(async e=>await Promise.all(e.map((async e=>{const t=await c(e);return new z.A(t)}))))(i)}catch{const e=new B.o_;return n.V.error(e),(0,s._q)(e)}return n.V.debug("rsdk.media.selectMedia.success"),(0,s.ok)([...i,...r])}catch(e){return n.V.error(Error(`Unknown error: ${e}`)),(0,s._q)(new B.D(e))}};async function R(e,t){if(t.length&&!e.length)return(0,s._q)(new B.o_);if(e.length){if(await O(e))return(0,s._q)(new B.ZN);try{const t=e.map((e=>new z.A(e)));return(0,s.ok)(t)}catch(e){return(0,s._q)(new B.D(e))}}return(0,s._q)(new B.Jr)}},80108:(e,t,i)=>{i.d(t,{z:()=>s});let s=function(e){return e.IMAGE="IMAGE",e.VIDEO="VIDEO",e}({})}}]);
//# sourceMappingURL=6977.86f10555f7e7917257bb.js.map